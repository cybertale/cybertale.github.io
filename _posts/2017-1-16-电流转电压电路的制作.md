---
layout: post
title: 电流转电压电路的制作
author: 宋强
tags: 电路
date: 2017-01-16 23:51 +0800
---

上一篇讲过了恒流源的制作，这一篇就讲一下怎么把恒流源产生的直流电流信号转换为单片机能够接受的电压信号。

废话不说，上原理图：

![](../../../images/c2v/Schemetic.jpg)

这个电路用到了一个LM324，里面的四个运放都用到了，一号用作电压跟随器，二号用作差分跟随器，三号用作同向减法器，四号用作同向放大器。

电路中的-5V电源是由一片TC7660产生的，这个芯片能够把1.5V到10V的输入电压通过电荷泵转换成相应的负电压，在后级运放的负载并不大的时候非常好用。

这里用到的都是最基础的运算放大器的应用，其中比较特别的就是二号，也是最重要的电流检测的部分。

由于运放的“断路”，电流输入只经过R10，这个电阻两端的电压将变为R*I，以4-20ma为例，电压变为0.4-2V，一号运放输出0.4V电压，通过三号的同向减法器之后，电压变为0-1.6V，再经过适当的放大，变为0-3.3V或者0-5V，最终输出电压为：

$$V_{输出} = \frac{R_{15}(100I_{输入} - 0.4v)}{10k \Omega}$$

这里有的小伙伴会问了，为什么不能直接用单片机测量R10两端的电压呢？

这里涉及到一个阻抗的问题，通常用来采样模拟信号的设备都会被配置为高阻态，意味着输入电阻很高，但有的时候这个电阻还是不够高，当后面的输入电阻不够高的时候，就会导致电流有一部分开始不经过R10而经过单片机，影响精度，甚至如果后级电路并不是配置为高阻态的引脚，而是其他的电压输入电路的时候，是没办法保证很高的输入阻抗的，所以利用这个运算放大器增大输入阻抗减小输出阻抗，对信号起到一个保持作用，同样一号运放起到的也是类似的作用，这也是射极跟随器和电压跟随器的主要应用场景。

PCB：

![](../../../images/c2v/PCB.jpg)

这是制作并测试成功的一个应用电路，其中U4是TC7660，主要到他是一个150KHz的高频电路，我把他的线画这么长是不对的，虽然实际应用可以，但是肯定会对其带载能力产生一定的影响，以后要注意。

实物：

![](../../../images/c2v/Test&#32;circute.jpg)

这是一个制作实物，作为三明治的一部分，中间的部分就是焊接并测试好的电路，看起来还不错哈哈。

TC7660少了一个电容，所以才留下那段鼻涕一样的东西。。为了把电容的另一只脚引到地。。。

因为当初飞卡留下的习惯，3296习惯用旋钮另一面的两只脚，这样逆时针是增大，顺时针是减小，设计这张板的时候这个问题没有考虑到，导致一个上一个下:disappointed:，不过还好用起来都挺好的，考虑到毕竟这一层在中间一般也没人看的到，美观不美观都不外见，还好啦还好啦。:smile: