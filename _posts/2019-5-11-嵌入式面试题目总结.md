---
layout: post
title: 嵌入式面试题目总结
author: 宋强
tags: linux
date: 2019-05-11 22:10 +0800
---

# uboot启动过程

1. 先在汇编里面设置中断向量表和各种模式下的堆栈。
2. 关闭FIQ和IRQ，防止程序跑到非预期位置。
3. 关闭MMU和Cache。
4. 进入板级初始化阶段，初始化时钟、内存和串口等外设，还会关闭看门狗。
5. 设置各种模式下的堆栈，准备C语言的运行环境，之后跳转到
6. uboot启动后芯片要处于SVC模式下。

# linux启动过程

# 为什么uboot的启动过程中要关闭cache

* ICache：设备上电时，内存比cpu的初始化慢一拍，而Cache是为了加快读取内存而使用的，如果内存还没准备好就对内存进行读取，很有可能会造成指令取址异常。
* DCache：用于虚拟地址映射，只有在开启MMU后才有意义。

# nand flash和nor flash区别

nand flash没法直接寻址，而nor flash可以直接寻址，所以可以XIP。

# uboot如何传参给内核

将基本参数放在R0-R2中，包括：
* R0：0x0。
* R1：机器号。
* R2：参数地址，地址下有标准参数表。

# linux内存管理的方式

# IPC方式有哪些

1. 管道
2. 明明管道
3. 共享内存
4. 消息队列
5. 信号量
6. 信号
7. 套接字

# ext4单层目录可以支持多少子文件

ext3支持32000个，ext4无限制。

# 内核的各种锁

* 原子操作：通常用于资源的引用计数，提供一些原子操作函数用于增减某个原子变量。
* 自旋锁（spinlock）：特点是持有者不会睡眠，通常要求持有时间很短。持有自旋锁的进程不可被抢占，所以要求内核可抢占或者使用SMP，否则会进入死锁。
* 读写锁（rwlock）：是一种特殊的自旋锁，规定了访问者分为读者和写者，只允许一个写者或者多个读者。
* 顺序自选锁（seqlock）：相比读写锁，允许写者和读者同时存在。但是有一个特别之处在于被保护的共享资源不可以有指针，因为写者可能使指针失效从而导致读着出现空指针错误。
* RCU（Read-Copy-Update）：写者写时先拷贝，然后在没有读者的时候写回去。
* 信号量（semaphore）：有一个初始值，每个持有进程减去一个。
* 读写信号量（rw_semaphore）：写者读者互斥，有且只有一个写者可以拥有信号量，没有写者的时候可以多个读者都拥有信号量。

